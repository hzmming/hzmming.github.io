(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{576:function(s,a,t){"use strict";t.r(a);var n=t(4),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[t("em",[s._v("写于 2020年8月27日。本文只是使用过后的一个简单记录，没有过多深入")])]),s._v(" "),t("h3",{attrs:{id:"一-monorepo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一-monorepo"}},[s._v("#")]),s._v(" 一 monorepo")]),s._v(" "),t("p",[s._v("关于 monorepo 与 multirepo，谁好谁坏，就不说了，而且我也不知道~~")]),s._v(" "),t("p",[s._v("monorepo，简单地说就是一个仓库里面存放了多个 npm 包，像 Babel、React、Vue 都有使用 monorepo。")]),s._v(" "),t("p",[s._v("举个简单的场景，比如一套系统有前端、后端两个部分，就可以构建如下项目结构")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("monorepo\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /packages\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /front\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /backend\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"二-yarn-workspaces"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二-yarn-workspaces"}},[s._v("#")]),s._v(" 二 yarn workspaces")]),s._v(" "),t("h4",{attrs:{id:"初始化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#初始化"}},[s._v("#")]),s._v(" 初始化")]),s._v(" "),t("p",[s._v("使用 yarn 初始化项目，并构建如上项目结构")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 初始化并生成package.json")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" init -y\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("strong",[s._v("/package.json")])]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 表明私有包（json中不能有注释，自己去掉）")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"private"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"workspaces"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"packages/*"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[t("strong",[s._v("front/package.json")])]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"font"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"version"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.0.0"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n \n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dependencies"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"cross-env"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5.0.5"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[t("strong",[s._v("backend/package.json")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"backend"')]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"version"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.0.0"')]),s._v(",\n \n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dependencies"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cross-env"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5.0.5"')]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("安装依赖")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("最终项目结构为")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("monorepo\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- yarn.lock\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /packages\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /front\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /backend\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("仔细一看，front 和 backend 都依赖了 cross-env，但 cross-env 只被安装在 根目录的 node_modules，并不会被多次安装于各个依赖的 package里。子项目的 node_modules 就一些 bin 之类的。")]),s._v(" "),t("p",[s._v("当然如果版本不一样，还是会各自安装自己的，只有一致了，才能提取至根目录")]),s._v(" "),t("h4",{attrs:{id:"添加依赖"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加依赖"}},[s._v("#")]),s._v(" 添加依赖")]),s._v(" "),t("p",[s._v("代码构建的公共部分放置根目录，业务及特有部分放置子项目目录")]),s._v(" "),t("h5",{attrs:{id:"子项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#子项目"}},[s._v("#")]),s._v(" 子项目")]),s._v(" "),t("p",[s._v("使用 yarn workspace 为子项目添加依赖，格式为"),t("code",[s._v("yarn workspace <workspace_name> <command>")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" workspace front "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" lodash uuid\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h5",{attrs:{id:"根目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#根目录"}},[s._v("#")]),s._v(" 根目录")]),s._v(" "),t("p",[s._v("如果直接向根目录添加依赖会报错，yarn 默认当作用户手误操作。使用 "),t("code",[s._v("-W")]),s._v("明确表示安装至根目录")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" -W "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" lodash\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"依赖内部包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#依赖内部包"}},[s._v("#")]),s._v(" 依赖内部包")]),s._v(" "),t("p",[s._v("新建一个内部 package，名叫 shared，用于放置一些公共代码，如 util.js")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("monorepo\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- yarn.lock\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /packages\n+   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /shared\n+     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- util.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /front\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /backend\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[t("strong",[s._v("shared/package.json")])]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"private"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shared"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"version"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" workspace front "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" shared@0.0.0\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("此处有个坑，"),t("strong",[s._v("安装内部包一定要指明版本号")]),s._v("。如果不指明，yarn 会跑到 npm 市场去搜索")]),s._v(" "),t("h4",{attrs:{id:"配置-git-忽略文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-git-忽略文件"}},[s._v("#")]),s._v(" 配置 git 忽略文件")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("monorepo\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- yarn.lock\n+ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .gitignore\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /packages\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /shared\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- util.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /front\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /backend\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[t("strong",[s._v(".gitignore")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("node_modules\npackages/front/dist\npackages/backend/dist\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h4",{attrs:{id:"使用-webpack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-webpack"}},[s._v("#")]),s._v(" 使用 webpack")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" -W "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" webpack webpack-cli -D\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("monorepo\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- yarn.lock\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .gitignore\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /packages\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /shared\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- util.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /front\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- webpack.config.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /backend\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n+     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- webpack.config.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("blockquote",[t("p",[s._v("只做示意，如安装在根目录或子目录，会遇到哪些问题，更具体的 webpack 相关依赖、相关知识并不在此展开")])]),s._v(" "),t("h4",{attrs:{id:"配置-eslint-与-prettier"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-eslint-与-prettier"}},[s._v("#")]),s._v(" 配置 eslint 与 prettier")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" -W "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" eslint prettier -D\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("eslint 配置文件会自动往上找，所以放置根目录即可")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("monorepo\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- yarn.lock\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .gitignore\n+ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .eslintignore\n+ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .eslintrc.js\n+ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .prettierrc.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /packages\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /shared\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- util.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /front\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- webpack.config.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /backend\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- webpack.config.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("p",[t("strong",[s._v(".eslintignore")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TODO vscode的eslint插件会读取该配置文件，但eslint-loader却不会~~")]),s._v("\nnode_modules\npackages/front/dist\npackages/backend/dist\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("strong",[s._v("有个问题，package里结合 webpack 使用 eslint-loader，虽然能读取到外层的 .eslintrc.js，但却不会读取 .eslintignore，尚未解决")])]),s._v(" "),t("p",[s._v("所以此处配置的 eslint 忽略文件是不起作用的，先配着，以后说不定就解决了")]),s._v(" "),t("h4",{attrs:{id:"使用-husky-和-lint-staged"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-husky-和-lint-staged"}},[s._v("#")]),s._v(" 使用 husky 和 lint-staged")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/sudo-suhas/lint-staged-multi-pkg",target:"_blank",rel:"noopener noreferrer"}},[s._v("lint-staged-multi-pkg"),t("OutboundLink")],1),s._v("介绍了3种方法，我采用了将 husky 和 lint-staged 安装至根目录")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" -W "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" husky lint-staged -D\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("monorepo\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- yarn.lock\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .gitignore\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .eslintignore\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .eslintrc.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .prettierrc.js\n+ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .lintstagedrc.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /packages\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /shared\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- util.js\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /front\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- webpack.config.js\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /backend\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- webpack.config.js\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("p",[t("strong",[s._v(".lintstagedrc.js")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"packages/front/**/*.{js,vue}"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"eslint --fix"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"packages/backend/**/*.{js,vue}"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"eslint --fix"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("strong",[s._v("package.json")])]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"private"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"workspaces"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"packages/*"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n+ "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"husky"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n+   "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"hooks"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n+     "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"pre-commit"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lint-staged"')]),s._v("\n+   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n+ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h4",{attrs:{id:"使用-postcss"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-postcss"}},[s._v("#")]),s._v(" 使用 postcss")]),s._v(" "),t("p",[s._v("配置文件放置根目录？这个还没验证，To be continued")]),s._v(" "),t("h4",{attrs:{id:"使用-commitizen"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-commitizen"}},[s._v("#")]),s._v(" 使用 commitizen")]),s._v(" "),t("p",[s._v("放置根目录，结合 husky 使用")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ui交互形式的commit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" -W "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" commitizen cz-conventional-changelog -D\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 校验commit message")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" -W "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" @commitlint/cli @commitlint/config-conventional -D\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成CHANGELOG.md")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" -W "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" conventional-changelog-cli -D\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("创建配置文件")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("monorepo\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- yarn.lock\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .gitignore\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .eslintignore\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .eslintrc.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .prettierrc.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .lintstagedrc.js\n+ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- commitlint.config.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /packages\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /shared\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- util.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /front\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- webpack.config.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /backend\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- webpack.config.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("p",[t("strong",[s._v("commitlint.config.js")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extends")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@commitlint/config-conventional"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("strong",[s._v("package.json")])]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"private"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"cz"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git cz"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"workspaces"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"packages/*"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"husky"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"hooks"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"pre-commit"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lint-staged"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      +     "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"commit-msg"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"commitlint -E HUSKY_GIT_PARAMS"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h4",{attrs:{id:"使用-babel"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-babel"}},[s._v("#")]),s._v(" 使用 babel")]),s._v(" "),t("p",[s._v("同样是安装在顶级，一样，只做示意")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" -W "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" @babel/core @babel/preset-env @babel/runtime-corejs3 -D\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("创建配置文件")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("monorepo\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- yarn.lock\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .gitignore\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .eslintignore\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .eslintrc.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .prettierrc.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .lintstagedrc.js\n+ "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- babel.config.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- commitlint.config.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /packages\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /shared\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- util.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /front\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- webpack.config.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /backend\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- webpack.config.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("p",[t("strong",[s._v("babel.config.js")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  plugins"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 公共部分")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  presets"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 公共部分")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// here: 子目录使用自己的配置文件 .babelrc.js/json")]),s._v("\n  babelrcRoots"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"packages/*"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("p",[s._v("子项目创建特有配置文件。比如我 front 使用了 ElementUI，很明显 backend 不需要，所以我不能放置在根目录")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("monorepo\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- yarn.lock\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .gitignore\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .eslintignore\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .eslintrc.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .prettierrc.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .lintstagedrc.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- babel.config.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- commitlint.config.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /packages\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /shared\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- util.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /front\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- webpack.config.js\n+     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .babelrc.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /backend\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- webpack.config.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("p",[t("strong",[s._v("front/.babelrc.js")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 子项目特有配置")]),s._v("\n  plugins"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("配置 babel-loader 整合父级配置文件")]),s._v(" "),t("p",[t("strong",[s._v("front/webpack.config.js")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n  module"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    rules"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        test"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/\\.js$/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        use"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            loader"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"babel-loader"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            options"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 向上找babel.config.js/json。也可以使用configFile自定义位置")]),s._v("\n              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 不配置这个将只使用本项目的 .babelrc 配置，而父级的 babel.config.js 不会起作用")]),s._v("\n              rootMode"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"upward"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/node_modules/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("h4",{attrs:{id:"使用-jest"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-jest"}},[s._v("#")]),s._v(" 使用 jest")]),s._v(" "),t("p",[s._v("子项目 front 使用 jest 进行单元测试和 e2e 测试")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" workspace front "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" jest\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("monorepo\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- yarn.lock\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .gitignore\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .eslintignore\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .eslintrc.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .prettierrc.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .lintstagedrc.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- babel.config.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- commitlint.config.js\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /packages\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /shared\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- util.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /front\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- webpack.config.js\n+     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /test\n+       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .babelrc.js\n+       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- xxx.spec.js\n+       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- jest.config.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- .babelrc.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /backend\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- /node_modules\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- webpack.config.js\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("- package.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("p",[t("strong",[s._v("front/jest.config.js")])]),s._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[s._v("module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  testEnvironment"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  verbose"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 指定 babel 配置文件")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// https://github.com/facebook/jest/issues/3845#issuecomment-582511237")]),s._v("\n  transform"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^.+\\\\.[jt]sx?$"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"babel-jest"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" configFile"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./test/.babelrc.js"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 路径相对 pwd()")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h4",{attrs:{id:"结合-lerna-待续"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#结合-lerna-待续"}},[s._v("#")]),s._v(" 结合 lerna（待续）")]),s._v(" "),t("p",[s._v("省点事，没有用上，以后用上再补充")]),s._v(" "),t("p",[s._v("https://zhuanlan.zhihu.com/p/71385053")]),s._v(" "),t("p",[s._v("https://github.com/hardfist/monorepo-starter")]),s._v(" "),t("h3",{attrs:{id:"三-参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三-参考"}},[s._v("#")]),s._v(" 三 参考")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/sudo-suhas/lint-staged-multi-pkg",target:"_blank",rel:"noopener noreferrer"}},[s._v("int-staged-multi-pkg"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("https://classic.yarnpkg.com/en/docs/workspaces/")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.jianshu.com/p/990afa30b6fe",target:"_blank",rel:"noopener noreferrer"}},[s._v("Yarn Workspace 使用指南"),t("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);